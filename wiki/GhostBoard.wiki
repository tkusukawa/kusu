#summary A windows tool to refer history of clipboard text on transparent dialog.

= !WinApp：!GhostBoard =

クリップボード操作(Ctrl+x,Ctrl+c,Ctrl+v)をしていて、
「いまちゃんとコピーできたかな？」
「ペーストしようとしているものは合ってる？」
と思って躊躇したことはないでしょうか。
文章をいじっていて、移動させるつもりで一部分をカットして、
別の操作を挟んだ際にクリップボードを使って消えてしまった、
ということはないでしょうか。
!GhostBoardはそんな方の役に立ちます。

「覚えきれないので文字列表示を見ながらコマンドを入力したい」とか
「いつもコピペする定形テキストを簡単に入力したい」
という方にも利用していただけると思います。

http://kusu.googlecode.com/files/ghostboardcap.jpg

== 動作環境 ==
Windows XP,Vista, Windows7で使えています。

==インストール／アンインストール==
インストーラではプログラムメニューとスタートアップにショートカットを作成し、
ユーザのアプリケーションデータフォルダに!GhostBoardフォルダを作成します。
コントロールパネルの「プログラム～」でアンインストールすることで、
作成したショートカットと!GhostBoardフォルダは削除されます。

レジストリは使用していません。EXEファイルを実行すると、
作業フォルダに設定情報のファイルが作られます。

==操作方法==
● !GhostBoardウィンドウのアクティブ化（移動、リサイズ、透明度）<br>
「アクティブキー」(デフォルトはCtrl)を長押しすることで
ウィンドウの透過モードが解除され、
ウィンドウ操作を行うことが可能になります。

長押ししながらウィンドウの端でマウスカーソルが十字矢印になったところで
ドラッグするとウィンドウが移動し、
ウィンドウの端でマウスカーソルが上下または左右の矢印になったところで
ドラッグするとウィンドウの大きさが変わります。

「アクティブキー」はデフォルト設定では「Ctrl」ですが、
Ctrl,Shift,Alt,Winの4つのキーの中から任意の組合せを設定することができます。
(タスクトレイ右クリック→Settings→active key)

表示が邪魔になる場合は透明度を変更することができます。
アクティブ化した時のウィンドウの透明度、通常のウィンドウの透明度および
マウスを近づけた際の透明度を個別に設定することができます。
(右クリック→Settings→ active alpha/default alpha/on mouse alpha)

● クリップボードの監視と履歴参照<br>
!GhostBoardはクリップボードへのコピーイベントを監視し、
コピーされたテキストを!GhostBoardウィンドウに即時表示します。
取得したコピーテキストは過去32個まで記憶しており、
ホットキーの上下（デフォルトはCtrl＋↑/↓）で順に履歴を呼び出して
クリップボードに書き戻すことができます。

ホットキー操作を行っても入力フォーカスは元のアプリケーションのままなので
ウィンドウ切り替えを行うことなく、編集作業を継続することができます。

参照操作時に前後の履歴番号とテキストの一部がバルーン表示されます。
（邪魔な場合は設定をOFFにしてください。右クリック→Settings→icon notif.）

履歴の参照と選択はマウス操作でも行うことができます。
タスクトレイの!GhostBoardアイコンを右クリックすることで
履歴の一覧をメニュー表示することができマウスクリックで選択できます。

● テキストグループの選択（定形テキスト）<br>
ホットキーの左右(デフォルトはCtrl＋←/→)で、
テキストグループを選択します。
テキストグループには「白」「赤」「緑」「青」の４つがあります。
「白」はクリップボードの履歴を参照するグループ、
その他のグループは定形テキストを保存・参照するグループとなっています。

各グループにはそれぞれ32個の定型文を保存することができ、
グループ選択後にホットキーの上下(デフォルトはCtrl＋↑/↓)で記憶領域を選択します。
(記憶領域番号はバルーン表示で確認できます)

定型文の記憶領域はマウス操作でも選択することができます。
タスクトレイのアイコンを右クリックし、
メニューの「red」「green」「blue」を選択すると
各グループの記憶領域がサブメニューとして表示されます。

● フォーカス（編集）<br>
アクテイブキーを押しながら!GhostBoardウィンドウを左クリックするか、
タスクトレイのアイコンを左クリックすることで
!GhostBoardウィンドウにフォーカスが与えられ、
選択中の記憶領域を編集できる状態になります。

編集状態に入ってからも
ホットキーの上下左右で記憶領域を切り替えることができます。

テキストグループ「赤」「緑」「青」の編集結果は設定ファイルに格納され、
次回起動時に復元されますが、クリップボード履歴(グループ白)の内容は
永続化されません。

● メニュー<br>
!GhostBoardウィンドウを右クリック
(フォーカスが無い状態ではアクティブキーを押しながら右クリック)するか、
タスクトレイのアイコンを右クリックすることで、
メニューを表示することができます。

● 設定<br>
メニューの「Settings」を選択することで設定ダイアログを表示します。
設定ダイアログでは、以下の設定を行うことができます。
１．各状態でのウィンドウ表示濃度
２．アクティブキーの組合せ
３．バルーン表示する／しない
４. ホットキーの変更

● 終了<br>
メニューの「Exit」を選択することで!GhostBoardを終了することが出来ます。

==連絡先==
バグレポートやご要望については本ページにコメント書き込むか、
「Issues」に書き込みをして頂けると助かります。

==開発環境==
!GhostBoardは!VisualStudio2005 !StandardEdition(VC++ MFC)で作っています。
ソースコードをSubversionのリポジトリの形で
http://kusu.googlecode.com/svn/trunk/WinApp/GhostBoard/
にて公開しています。
自分が欲しい機能を試行錯誤を繰り返して加えてきたものなので、
間違いなどがあるかもしれませんが、何かの参考になれば幸いです。
お気づきの点がございましたらご連絡いただけると助かります。

== バイナリダウンロード ==

  * [http://kusu.googlecode.com/files/GhostBoardInstaller-1.1.14.zip GhostBoard-1.1.14 インストーラ]
  * [http://kusu.googlecode.com/files/GhostBoard-1.1.14.zip GhostBoard-1.1.14 EXEファイル]
    2010/04/18 r150<br>
    履歴探索時のバルーン表示の文字数等を調整<br>
    !ReadMeブラッシュアップ<br>
    2010/04/18 r149<br>
    定型文のIndex参照方向を反転<br>
    2010/04/12 r148<br>
    ホットキーによる参照時にリストをバルーン表示<br>
    2010/04/11 r146<br>
    ウィンドウがスクリーンの上や左にとび出した場合もスクリーン内に連れ戻すように修正<br>
    メニューをESCでキャンセルした場合はフォーカスを捨てるように修正<br>
    2010/04/11 r145<br>
    ホットキー設定機能を追加<br>
    2010/04/10 r144<br>
    !GhostBoardウィンドウでの最後の操作がコピーであれば、表示内容ではなくコピー内容をクリップボードに残すように修正<br>

  * [http://kusu.googlecode.com/files/GhostBoardInstaller-1.1.12.zip GhostBoard-1.1.12 インストーラ]
  * [http://kusu.googlecode.com/files/GhostBoard-1.1.12.zip GhostBoard-1.1.12 EXEファイル]
    2010/03/27 r142<br>
    ホットキーで履歴を参照した際に履歴を更新してしまう場合があった問題を修正

  * [http://kusu.googlecode.com/files/GhostBoardInstaller-1.1.11.zip GhostBoard-1.1.11 インストーラ]
  * [http://kusu.googlecode.com/files/GhostBoard-1.1.11.zip GhostBoard-1.1.11 EXEファイル]
    2010/03/22 r138<br>
    !ReadMe.txtへの操作方法の追記<br>
    登録されていない定型文の記憶領域をメニューに表示するように修正<br>
    (久米様：ご助言ありがとうございました)<br>
    起動直後にフォーカスを失っても透明化されない場合があった問題の修正<br>
    定型文を選択した際にクリップボード履歴を追加してしまう場合があった問題の修正

  * [http://kusu.googlecode.com/files/GhostBoardInstaller-1.1.10.zip GhostBoard-1.1.10 インストーラ]
  * [http://kusu.googlecode.com/files/GhostBoard-1.1.10.zip GhostBoard-1.1.10 EXEファイル]
    2010/03/20 r136<br>
    クリップボード監視の正常性確認をアクティブキー操作毎に行うように修正<br>
    稀にフォーカス状態の認識が切り替わり続ける問題の修正<br>
    メニューから履歴/定型文を選択した際にフォーカスを元のアプリに戻す機能を追加

  * [http://kusu.googlecode.com/files/GhostBoardInstaller-1.1.9.zip GhostBoard-1.1.9 インストーラ]
  * [http://kusu.googlecode.com/files/GhostBoard-1.1.9.zip GhostBoard-1.1.9 EXEファイル]
    2010/03/13 r131<br>
    インストーラを追加<br>
    クリップボードチェインに更新イベントを渡せていなかった問題の修正<br>
    クリップボードチェインから外れていた場合に再接続する仕組みを実装<br>
    履歴のメニュー選択をサブメニューからメインメニューに変更

  * [http://kusu.googlecode.com/files/GhostBoard-1.1.8.zip GhostBoard-1.1.8]
    2010/03/06 r129<br>
    クリップボード文字列の取得処理を別スレッドで処理することで連続イベント通知に対して一度しか処理を行わないように効率化<br>
    履歴参照時に履歴を追加してしまう不具合を修正<br>
    フォーカス時にクリップボードを更新してしまう問題を修正<br>
    スクリーンサイズが小さくなったときにスクリーンに入る位置に移動する機能を実装

  * [http://kusu.googlecode.com/files/GhostBoard-1.1.7.zip GhostBoard-1.1.7]
    2010/02/27 r126<br>
    テキスト以外がクリップボードにある時のダイアログの色がグレーになるように修正<br>
    テキスト以外がクリップボードにあがった後にインデックス番号がおかしくなる不具合の修正

  * [http://kusu.googlecode.com/files/GhostBoard-1.1.6.zip GhostBoard-1.1.6]
    2010/01/18 r113 r114 r115 r116<br>
    アクティブ時の透明度を設定できるように修正<br>
    デフォルトのウィンドウ位置が右下になるように修正<br>
    アクティブになった際に必ず最前面に表示されるように修正<br>
    非表示設定の機能を削除（透明度を０に設定すれば良いので）<br>
    バルーン表示する／しないを設定できる機能を追加<br>
    履歴や定形テキストをメニューから選択できる機能を追加

  * [http://kusu.googlecode.com/files/GhostBoard-1.1.5.zip GhostBoard-1.1.5(BETA)]
    2010/01/10 r110<br>
    エクセルのセルをコピーすると正常にクリップボードを監視出来なくなる問題の対応<br>
    ファイルコピー時にファイルのパスを表示するように修正

  * !GhostBoard-1.1.4(BETA)
    2010/01/10 r105 r107 r108<br>
    クリップボードの更新タイミングを「アクテイブキーOFF時」→「履歴表示時」に変更<br>
    アクティブキーのデフォルトを「Ctrl+Alt」→「Ctrl」に変更<br>
    デフォルトの透明度を変更(薄く)<br>
    クリップボードの内容がテキストでない時は「not TEXT」をバルーン表示するように修正<br>
    クリップボードテキストの取得処理をリファクタリング<br>

  * [http://kusu.googlecode.com/files/GhostBoard-1.1.3.zip GhostBoard-1.1.3.zip]
    2009/11/16 r88<br>
    「Issue 11: テンプレートの編集内容が保持されない場合がある」への対応<br>

  * [http://kusu.googlecode.com/files/GhostBoard-1.1.2.zip GhostBoard-1.1.2.zip]
    2009/11/08 r83<br>
    アクティブキーにWindowsキーを追加<br>
    アクティブキーの一部だけを押した時に一瞬アクティブになる問題を修正<br>
    2009/11/14 r84<br>
    テキストテンプレート機能を追加<br>
    2009/11/15 Rev.85<br>
    フォーカス消失のイベントを取りこぼす問題への対応<br>
    アクティブキー＋Enterでフォーカス取得(テンプレート編集)できるように修正<br>
    README.txtを記述<br>

  * [http://kusu.googlecode.com/files/GhostBoard-1.0.0.8.zip GhostBoard-1.0.0.8.zip]
    2009/11/08 r80<br>
    起動時の履歴が無い状態で履歴を参照するとエラーになっていた不具合を修正<br>
    履歴番号を最新との差ではなく、起動時からのカウント番号を表示するように修正<br>
    クリップボードへのテキストコピーのタイミングで番号をバルーン表示するように修正<br>
    バルーン表示が決まった時間にきちんと消えるように修正

  * [http://kusu.googlecode.com/files/GhostBoard-1.0.0.7.zip GhostBoard-1.0.0.7.zip]
    2009/11/07 r76<br>
    透明度とアクティブキーを設定で変更できるように修正

  * [http://kusu.googlecode.com/files/GhostBoard-1.0.0.6.zip GhostBoard-1.0.0.6.zip]
    2009/11/03 r74<br>
    タスクトレイに格納するように修正<br>
    クリップボードの履歴の番号とコピーした時刻をバルーン表示するように修正<br>
    使われていない履歴配列は表示しないように修正

  * [http://kusu.googlecode.com/files/GhostBoard-1.0.0.5.zip GhostBoard-1.0.0.5.zip]
    2009/11/01 r70 
    履歴編集中のコピペのおかしな挙動を修正

  * [http://kusu.googlecode.com/files/GhostBoard-1.0.0.4.zip GhostBoard-1.0.0.4.zip]
    2009/10/31
    ホットキーで過去のコピーの履歴をクリップボードに呼び出せるように修正

  * [http://kusu.googlecode.com/files/ghostboard-1.0.0.3.zip ghostboard-1.0.0.3.zip]